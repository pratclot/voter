<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <!-- including ECharts file -->
{% load static %}
    <script type="text/javascript" src="{% static "echarts.js" %}"></script>
</head>

<body>
{% load filters %}
<h1>{{ poll.poll_question }}</h1>

<ul>
{% for poll_vote, answer in poll_votes.items %}
    <li>{{  answer.answer_text }} -- {{ poll_vote.votes }}
        vote{{ poll_vote.votes|pluralize }}</li>
{% endfor %}
</ul>
<form action="{% url 'movies:poll_detail' poll.id %}">
    <input type="submit" value="Vote again?"/>
</form>
<form action="{% url 'movies:polls' %}">
    <input type="submit" value="Movies"/>
</form>
    <!-- preparing a DOM with width and height for ECharts -->
    <div id="main" style="border:1px; border-style:solid; width:100%; height:400px; margin-top:10px;"></div>
    <script type="text/javascript">
        // based on prepared DOM, initialize echarts instance
        var myChart = echarts.init(document.getElementById('main'));

        // specify chart configuration item and data
        var option = {
            title: {
                text: 'This is what ignorance results in'
            },
            tooltip: {},
            legend: {
                type: 'scroll',
                orient: 'vertical',
                right: 10,
                top: 20,
                bottom: 20,
                data: {{ answers|safe }},
                selected: {{ chart_selected|safe }}
            },
            series: [{
                name: 'Votes',
                type: 'pie',
                data: {{ chart_data|safe }}
            }]
        };

        // use configuration item and data specified to show chart
        myChart.setOption(option);
    </script>
    <div id="voters_chart" style="border:1px; border-style:solid; width:100%;
     height:400px; margin-top:10px;"></div>
    <script type="text/javascript">
        // based on prepared DOM, initialize echarts instance
        var votersChart = echarts.init(document.getElementById('voters_chart'));

        // specify chart configuration item and data
        var option = {
            title: {
                text: 'Who voted so far'
            },
            tooltip: {
                show: true
            },
            toolbox: {
                show: true
            },
            xAxis: {
                type: 'category',
                data: {{ all_voters|safe }}
            }, 
            yAxis: {
                type: 'value'
            },
            series: [{
                name: 'Voters',
                type: 'bar',
                data: {{ current_voters|safe }}
            }]
        };

        // use configuration item and data specified to show chart
        votersChart.setOption(option);
    </script>
</body>

</html>

